"use strict";angular.module("angular-cardflow",["ngTouch"]).directive("cardflow",["$swipe","$compile","$window",function(a,b,c){return{restrict:"E",template:'<div class="cardflow-container" ng-transclude ng-swipe-left="swipeLeft()" ng-swipe-right="swipeRight()"></div>',transclude:!0,scope:{model:"=?",atype:"=?",margin:"=?",animTime:"=?",current:"=?"},link:function(b,d,e){function f(){j.css({transform:"translate3d("+b.position+"px,0,0)","-webkit-transform":"translate3d("+b.position+"px,0,0)","-o-transform":"translate3d("+b.position+"px,0,0)","-moz-transform":"translate3d("+b.position+"px,0,0)"}),j.removeClass("cardflow-active");var a=angular.element(j[b.model.current]);a.addClass("cardflow-active"),b.model.onActive&&b.model.onActive(a,b.position,b)}function g(a){k=j[1].offsetLeft,l=k+i*j.length,(0===a||-1===a&&b.model.current>0||1===a&&b.model.current<j.length-1)&&(j=d.children().children(),i=j[1].offsetHeight+b.margin,b.model.current+=a,b.position=-(b.model.current*i),f())}function h(){if(j=d.children().children(),j&&j.length){if(i=j[1].offsetHeight+b.margin,angular.forEach(j,function(a,b){angular.element(a).css({left:b*i+"px"})}),g(0),"swipeSnap"==b.atype){var c=0,e=0;a.bind(d,{start:function(a){c=(new Date).getTime(),e=a.x},end:function(a){var d=a.x-e,f=Math.abs(d),h=(new Date).getTime(),i=(h-c)/(1e5*b.animTime);i=f*i;var k=d>0?-1:1;console.log(i,k);var l=b.model.current+Math.floor(i*k);0>l&&(l=0),l>j.length-1&&(l=j.length-1),b.model.current=l,b.$apply(),g(0)},move:function(){}})}}else setTimeout(h,1)}b.model=b.model||{},b.atype=e.atype||"swipeSnap",b.margin=b.margin||10,b.animTime=b.animTime||.25,b.model.current=b.current||0,b.$watch("model.current",h);var i,j,k,l;b.$watch("type",h),angular.element(c).bind("resize",function(){g(0)}),b.swipeLeft=function(){"swipeSnapOne"==b.atype&&g(1)},b.swipeRight=function(){"swipeSnapOne"==b.atype&&g(-1)}}}}]);