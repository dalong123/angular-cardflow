"use strict";!function(){var a=function(a,b){var c,d,e=window.getComputedStyle(a);if(e){if(angular.forEach(["moz","o","webkit"],function(a){e[a+"Transform"]&&(c=e[a+"Transform"],d=a)}),c){var f=c.match(/\d+/g);f=f&&6==f.length?f.map(function(a){return Number(a)}):[1,0,0,1,0,0]}else f=[1,0,0,1,0,0];for(var g=0;6>g;g++)void 0!==b[g]&&(f[g]=b[g]);var h={};d?h[d+"Transform"]="matrix("+f.join(",")+")":h.transform="matrix("+f.join(",")+")",angular.element(a).css(h)}},b=angular.module("angular-cardflow",["ngTouch"]);b.directive("cardflow",["$swipe","$timeout",function(b,c){return{restrict:"E",template:'<div class="cardflow-wrapper" ng-swipe-left="swipeLeft($event)" ng-swipe-right="swipeRight($event)"><div class="cardflow-container" ng-transclude></div></div>',transclude:!0,scope:{model:"=?",mode:"=?",current:"=?"},link:function(d,e,f){c(function(){function c(b){a(d.model.containerEl[0],[void 0,void 0,void 0,void 0,b,void 0])}if(d.model=d.model||{},d.model.cardWidth=0,d.model.wrapperEl=angular.element(e.find("div")[0]),d.model.containerEl=angular.element(d.model.wrapperEl.find("div")[0]),d.model.current=d.current||d.model.current||0,d.model.cards=d.model.cards||[],d.mode=f.mode||"swipeSnapKinetic",d.model.increment=1,d.model.setPositionX=c,d.$watch(function(){return d.model.cards},function(){if(d.model.cardEls=d.model.containerEl.children(),d.model.cardEls&&d.model.cardEls[1]){d.model.cardWidth=d.model.cardEls[1].offsetLeft-d.model.cardEls[0].offsetLeft,0===d.model.cardWidth&&(d.model.cardWidth=d.model.cardEls[0].offsetWidth);var a=d.model.cardWidth*d.model.cardEls.length+d.model.cardEls[1].offsetLeft;d.model.containerEl.css({width:a+"px"}),d.model.pageSize=Math.floor(d.model.wrapperEl[0].clientWidth/d.model.cardWidth),d.model.increment="swipeSnapOne"==d.mode?1:d.model.pageSize}}),"swipe"!=d.mode&&d.$watch(function(){return d.model.current},function(){if(d.model.cardEls){d.model.cardEls.removeClass("cardflow-active");var a=angular.element(d.model.cardEls[d.model.current]);a.addClass("cardflow-active"),d.model.cardWidth&&c(d.model.cardWidth*-d.model.current)}}),("swipeSnapOne"==d.mode||"swipeSnapPage"==d.mode)&&(d.swipeLeft=function(){var a=d.model.current+d.model.increment;a<d.model.cardEls.length&&(d.model.current=a)},d.swipeRight=function(){var a=d.model.current-d.model.increment;a>=0&&(d.model.current=a)}),"swipeSnap"==d.mode||"swipeSnapKinetic"==d.mode||"swipe"==d.mode){var g={},h=window.getComputedStyle(d.model.containerEl[0]).transition;h&&(g.transition=h+""),angular.forEach(["moz","o","webkit","ms"],function(a){h=window.getComputedStyle(d.model.containerEl[0])[a+"Transition"],h&&(g[a+"Transition"]=h)});var i,j=0,k=0,l=0;b.bind(d.model.wrapperEl,{start:function(a){d.model.cardEls.removeClass("cardflow-active"),j="swipe"==d.mode?a.x-k:a.x,angular.forEach(["moz","o","webkit","ms"],function(a){d.model.containerEl.css(a+"Transition","none")}),d.model.containerEl.css({transition:"none"}),"swipeSnapKinetic"==d.mode&&(l=0,i=Date.now())},end:function(a){if(d.model.containerEl.css(g),"swipe"!=d.mode){var b=Math.floor(k/-d.model.cardWidth+.5);if("swipeSnapKinetic"==d.mode){var c=Date.now(),e=c-i,f=j-a.x,h=f/e;Math.abs(h)>1&&(b=Math.floor(b+h))}b>=0?b>d.model.cardEls.length-1&&(b=d.model.cardEls.length-1):b=0,d.model.current==b&&(d.model.current=-1,d.$apply()),d.model.current=b,d.$apply()}},move:function(a){k="swipe"!=d.mode?a.x-d.model.current*d.model.cardWidth-j:a.x-j,c(k)}})}})}}}])}();